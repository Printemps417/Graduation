!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Superstruct={})}(this,(function(e){"use strict";class t extends TypeError{constructor(e,t){const{message:n,...r}=e,{path:c}=e;let i;super(0===c.length?n:"At path: "+c.join(".")+" -- "+n),Object.assign(this,r),this.name=this.constructor.name,this.failures=()=>(i||(i=[e,...t]),i)}}function n(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;const t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function r(e){return"string"==typeof e?JSON.stringify(e):""+e}function c(e){const{done:t,value:n}=e.next();return t?void 0:n}function*i(e,t){if("string"==typeof e)yield t.fail({message:e});else{if(!0===e)return;!1===e?yield t.fail():yield*e}}function o(e,t){return new y({type:e,schema:null,validator:t})}function u(){return o("never",(()=>!1))}function s(e){const t=e?Object.keys(e):[],n=u();return new y({type:"object",schema:e||null,*validator(c,i){if("object"!=typeof c||null==c)yield i.fail("Expected an object, but received: "+r(c));else if(e){const r=new Set(Object.keys(c));for(const n of t){r.delete(n);const t=e[n],o=c[n];yield*i.check(o,t,c,n)}for(const e of r){const t=c[e];yield*i.check(t,n,c,e)}}},coercer:n=>{if(!e||"object"!=typeof n||null==n)return n;const r={},c=new Set(Object.keys(n));for(const i of t){c.delete(i);const t=e[i],o=n[i];r[i]=t.coercer(o)}for(const e of c)r[e]=n[e];return r}})}function f(e){const{refiner:t}=e;return new y({...e,validator:(t,n)=>void 0===t||n.check(t,e),refiner:function*(n,r){if(null!=n){const c={...r,struct:e};yield*i(t(n,c),c)}}})}function a(){return o("string",(e=>"string"==typeof e||"Expected a string, but received: "+r(e)))}function l(){return o("unknown",(()=>!0))}function d(e,t,n){const r=e.coercer;return new y({...e,coercer:e=>v(e,t)?r(n(e)):r(e)})}function p(e){return d(e,l(),(t=>{if("object"!=typeof e.schema||null==e.schema||"object"!=typeof t||null==t)return t;{const n={};for(const r in e.schema)r in t&&(n[r]=t[r]);return n}}))}class y{constructor(e){this.type=e.type,this.schema=e.schema,this.coercer=e.coercer||(e=>e),this.validator=e.validator||(()=>[]),this.refiner=e.refiner||(()=>[])}assert(e){return h(e,this)}create(e){return b(e,this)}is(e){return v(e,this)}mask(e){return m(e,this)}validate(e,t={}){return g(e,this,t)}}function h(e,t){const n=g(e,t);if(n[0])throw n[0]}function b(e,t){const n=t.coercer(e);return h(n,t),n}function m(e,t){return b(e,p(t))}function v(e,t){return!g(e,t)[0]}function g(e,n,r={}){r.coerce&&(e=n.coercer(e));const i=x(e,n),o=c(i);if(o){return[new t(o,i),void 0]}return[void 0,e]}function*x(e,t,n=[],o=[]){const u={value:e,struct:t,branch:o,path:n,check:(e,t,r,c)=>x(e,t,void 0!==r?[...n,c]:n,void 0!==r?[...o,r]:o),fail(c={}){"string"==typeof c&&(c={message:c});const{type:i}=t;let{message:u,refinement:s}=c;return u||(u="Expected a value of type `"+i+"`"+(s?" with refinement `"+s+"`":"")+(n.length?" for `"+n.join(".")+"`":"")+", but received: `"+r(e)+"`"),{...c,value:e,type:i,refinement:s,message:u,key:n[n.length-1],path:n,branch:[...o,e]}}},s=i(t.validator(e,u),u),f=c(s);f?(yield f,yield*s):yield*i(t.refiner(e,u),u)}function j(e,t,n){const r=e.refiner;return new y({...e,*refiner(e,c){yield*i(r(e,c),c);for(const r of i(n(e,c),c))yield{...r,refinement:t}}})}e.Struct=y,e.StructError=t,e.any=function(){return o("any",(()=>!0))},e.array=function(e){return new y({type:"array",schema:e,coercer:t=>e&&Array.isArray(t)?t.map((t=>e.coercer(t))):t,*validator(t,n){if(Array.isArray(t)){if(e)for(const[r,c]of t.entries())yield*n.check(c,e,t,r)}else yield n.fail("Expected an array value, but received: "+r(t))}})},e.assert=h,e.assign=function(...e){const t=e.map((e=>e.schema));return s(Object.assign({},...t))},e.boolean=function(){return o("boolean",(e=>"boolean"==typeof e))},e.coerce=d,e.create=b,e.date=function(){return o("date",(e=>e instanceof Date&&!isNaN(e.getTime())||"Expected a valid `Date` object, but received: "+r(e)))},e.defaulted=function(e,t,r={}){const{strict:c}=r;return d(e,l(),(e=>{const r="function"==typeof t?t():t;if(void 0===e)return r;if(!c&&n(e)&&n(r)){const t={...e};let n=!1;for(const e in r)void 0===t[e]&&(t[e]=r[e],n=!0);if(n)return t}return e}))},e.define=o,e.dynamic=function(e){return o("dynamic",((t,n)=>n.check(t,e(t,n))))},e.empty=function(e){const t="Expected an empty "+e.type;return j(e,"empty",(e=>{if(e instanceof Map||e instanceof Set){const{size:n}=e;return 0===n||t+" but received one with a size of `"+n+"`"}{const{length:n}=e;return 0===n||t+" but received one with a length of `"+n+"`"}}))},e.enums=function(e){const t={},n=e.map((e=>r(e))).join();for(const n of e)t[n]=n;return new y({type:"enums",schema:t,validator:t=>e.includes(t)||"Expected one of `"+n+"`, but received: "+r(t)})},e.func=function(){return o("func",(e=>"function"==typeof e||"Expected a function, but received: "+r(e)))},e.instance=function(e){return o("instance",(t=>t instanceof e||"Expected a `"+e.name+"` instance, but received: "+r(t)))},e.integer=function(){return o("integer",(e=>"number"==typeof e&&!isNaN(e)&&Number.isInteger(e)||"Expected an integer, but received: "+r(e)))},e.intersection=function(e){return o("intersection",(function*(t,n){for(const r of e)yield*n.check(t,r)}))},e.is=v,e.lazy=function(e){let t;return o("lazy",((n,r)=>(t||(t=e()),r.check(n,t))))},e.literal=function(e){const t=r(e);return o("literal",(n=>n===e||"Expected the literal `"+t+"`, but received: "+r(n)))},e.map=function(e,t){return o("map",(function*(n,c){if(n instanceof Map){if(e&&t)for(const[r,i]of n.entries())yield*c.check(r,e,n,r),yield*c.check(i,t,n,r)}else yield c.fail("Expected a `Map` object, but received: "+r(n))}))},e.mask=m,e.masked=p,e.max=function(e,t,n={}){const{exclusive:r}=n;return j(e,"max",(n=>r?n<t:n<=t||"Expected a "+e.type+" greater than "+(r?"":"or equal to ")+t+" but received `"+n+"`"))},e.min=function(e,t,n={}){const{exclusive:r}=n;return j(e,"min",(n=>r?n>t:n>=t||"Expected a "+e.type+" greater than "+(r?"":"or equal to ")+t+" but received `"+n+"`"))},e.never=u,e.nullable=function(e){const{refiner:t}=e;return new y({...e,validator:(t,n)=>null===t||n.check(t,e),refiner:function*(n,r){if(null!=n){const c={...r,struct:e};yield*i(t(n,c),c)}}})},e.number=function(){return o("number",(e=>"number"==typeof e&&!isNaN(e)||"Expected a number, but received: "+r(e)))},e.object=s,e.omit=function(e,t){const{schema:n}=e,r={...n};for(const e of t)delete r[e];return s(r)},e.optional=f,e.partial=function(e){const t=e instanceof y?{...e.schema}:{...e};for(const e in t)t[e]=f(t[e]);return s(t)},e.pattern=function(e,t){return j(e,"pattern",(n=>t.test(n)||"Expected a "+e.type+" matching `/"+t.source+'/` but received "'+n+'"'))},e.pick=function(e,t){const{schema:n}=e,r={};for(const e of t)r[e]=n[e];return s(r)},e.record=function(e,t){return o("record",(function*(n,c){if("object"!=typeof n||null==n)yield c.fail("Expected an object, but received: "+r(n));else for(const r in n){const i=n[r];yield*c.check(r,e,n,r),yield*c.check(i,t,n,r)}}))},e.refine=j,e.regexp=function(){return o("regexp",(e=>e instanceof RegExp))},e.set=function(e){return o("set",(function*(t,n){if(t instanceof Set){if(e)for(const r of t)yield*n.check(r,e,t,r)}else yield n.fail("Expected a `Set` object, but received: "+r(t))}))},e.size=function(e,t,n=t){const r="Expected a "+e.type,c=t===n?"of `"+t+"`":"between `"+t+"` and `"+n+"`";return j(e,"size",(e=>{if("number"==typeof e||e instanceof Date)return t<=e&&e<=n||r+" "+c+" but received `"+e+"`";if(e instanceof Map||e instanceof Set){const{size:i}=e;return t<=i&&i<=n||r+" with a size "+c+" but received one with a size of `"+i+"`"}{const{length:i}=e;return t<=i&&i<=n||r+" with a length "+c+" but received one with a length of `"+i+"`"}}))},e.string=a,e.struct=function(e,t){return console.warn("superstruct@0.11 - The `struct` helper has been renamed to `define`."),o(e,t)},e.trimmed=function(e){return d(e,a(),(e=>e.trim()))},e.tuple=function(e){const t=u();return o("tuple",(function*(n,c){if(Array.isArray(n)){for(const[t,r]of e.entries()){const e=n[t];yield*c.check(e,r,n,t)}if(n.length>e.length){const r=e.length,i=n[r];yield*c.check(i,t,n,r)}}else yield c.fail("Expected an array, but received: "+r(n))}))},e.type=function(e){const t=Object.keys(e);return new y({type:"type",schema:e,validator:function*(n,c){if("object"!=typeof n||null==n)yield c.fail("Expected an object, but received: "+r(n));else for(const r of t){const t=e[r],i=n[r];yield*c.check(i,t,n,r)}}})},e.union=function(e){const t=e.map((e=>e.type)).join(" | ");return o("union",(function*(n,c){const i=[];for(const t of e){const[...e]=c.check(n,t);if(0===e.length)return;i.push(...e)}yield c.fail("Expected the value to satisfy a union of `"+t+"`, but received: "+r(n)),yield*i}))},e.unknown=l,e.validate=g,Object.defineProperty(e,"__esModule",{value:!0})}));
